---
layout: default
title: Overview
---

# JAX Distillation Column Simulator

> **Disclaimer:** This is an experimental simulator. All claims in the documentation were generated by an LLM and should be independently validated before being trusted.

A high-fidelity, JAX-native distillation column simulator designed for reinforcement learning research with sim-to-real transfer capability.

## Features

- **JAX-Native**: Fully JIT-compilable and vmap-compatible for fast parallel simulations
- **Gymnasium-Compatible**: Standard RL environment interface for easy integration with RL libraries
- **Physically Accurate**: NRTL thermodynamics, Murphree efficiency, hydraulic dynamics
- **Configurable**: Flexible column geometry, mixture properties, and operating conditions
- **Validated**: 246 tests covering thermodynamics, hydraulics, dynamics, and physics benchmarks

## Quick Start

### As an RL Environment

```python
from jax_distillation import DistillationColumnEnv

# Create environment
env = DistillationColumnEnv()

# Standard Gymnasium interface
obs, info = env.reset()
for _ in range(100):
    action = env.action_space.sample()
    obs, reward, terminated, truncated, info = env.step(action)
    if terminated or truncated:
        break

print(f"Final distillate purity: {info['outputs']['x_D']:.3f}")
print(f"Final bottoms purity: {info['outputs']['x_B']:.3f}")
```

### Direct Simulation (without RL)

```python
from jax_distillation import (
    create_teaching_column_config,
    create_initial_column_state,
    create_default_action,
    column_step,
)

# Create column configuration
config = create_teaching_column_config(
    n_trays=10,
    feed_tray=5,
    feed_composition=0.5,  # 50% methanol
)

# Initialize state
state = create_initial_column_state(config)

# Define control action
action = create_default_action(
    Q_R=5000.0,      # Reboiler duty [W]
    reflux_ratio=3.0, # Reflux ratio
)

# Run simulation
for _ in range(100):
    state, outputs = column_step(state, action, config)

print(f"Distillate composition: {float(outputs.x_D):.3f}")
print(f"Bottoms composition: {float(outputs.x_B):.3f}")
```

## Documentation

- [Research Foundation](docs/phase1) - Dynamic model specification with all equations
- [Implementation Plan](docs/implementation_plan) - Detailed implementation roadmap
- [Handoff Documentation](HANDOFF) - Usage guide for RL practitioners and chemical engineers

## Installation

```bash
# Clone the repository
git clone https://github.com/bradknox/distillation-jax.git
cd distillation-jax

# Install in development mode
pip install -e .

# For RL training (optional)
pip install stable-baselines3
```

## Physical Model

The simulator implements:

- **Thermodynamics**: NRTL activity coefficient model for non-ideal VLE, Antoine equation for vapor pressure
- **Tray Dynamics**: MESH equations (Material, Equilibrium, Summation, Heat balance)
- **Hydraulics**: Francis weir formula, hydraulic time lag, flooding/weeping correlations
- **Efficiency**: Murphree vapor efficiency model

Default mixture: Methanol-water at atmospheric pressure.

## References

- Wittgens & Skogestad (2000) - Hydraulics and control-relevant dynamics
- NIST WebBook - Antoine coefficients
- NPTEL Module 7 - Flooding/weeping correlations
- Armfield UOP3 - Teaching column specifications

## License

MIT License
